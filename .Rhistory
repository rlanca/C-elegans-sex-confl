library(gdata)
library(coxme)
library(multcomp)
library(lme4)
library(survival)
library(dplyr)
library(RColorBrewer)
setwd("~/Desktop/scripts_and_data/csv files")
original <- read.csv(file="RL_031719.csv", header=TRUE, sep=",")
lifespan1 <- subset(original, select = c("Replicate", "Condition.1", "Condition.2", "Age.at.Death", "Censored", "Plate.Column", "Plate.Row", "Strain"))
names(lifespan1) <- c("replicate", "condition.1", "condition.2", "death.age", "censored", "column", "row", "strain")
lifespan1$treatment <- with(lifespan1, interaction(condition.1, condition.2, strain))
lifespan1$plate <- with(lifespan1, interaction(column, row))
lifespan1$dead <- 1
JK574.equal <- subset(lifespan1, treatment == "mated.equal.JK574", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
JK574.skew <- subset(lifespan1, treatment == "mated.skew.JK574", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
JK574.virgin <- subset(lifespan1, treatment == "virgin.null.JK574", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
combined.JK574 <- rbind(JK574.mated, JK574.virgin, JK574.equal)
combined.JK574$SurvObj <- with(combined.JK574, Surv(death.age, censored == 0))
model.plot2 <- survfit(SurvObj ~ treatment, data = combined.JK574, conf.type = "log-log")
summary(model.plot2)
mycols2 <- c("blue", "red", "green")
JK574.equal <- subset(lifespan1, treatment == "mated.equal.JK574", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
JK574.skew <- subset(lifespan1, treatment == "mated.skew.JK574", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
JK574.virgin <- subset(lifespan1, treatment == "virgin.null.JK574", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
combined.JK574 <- rbind(JK574.skew, JK574.virgin, JK574.equal)
combined.JK574$SurvObj <- with(combined.JK574, Surv(death.age, censored == 0))
model.plot2 <- survfit(SurvObj ~ treatment, data = combined.JK574, conf.type = "log-log")
summary(model.plot2)
lifespan2 <- read.csv("RL_010419CC.csv", header = T)
lifespan2 <- subset(lifespan2, select = c("Replicate", "Condition1", "Condition2", "Ageofdeath", "Censored", "Plate.Column", "Plate.Row", "Strain", "Dead"))
names(lifespan2) <- c("replicate", "condition.1", "condition.2", "death.age", "censored", "column", "row", "strain", "dead")
lifespan2$treatment <- with(lifespan2, interaction(condition.1, condition.2, strain))
lifespan2$plate <- with(lifespan2, interaction(replicate, column, row))
head(lifespan2)
lifespan2 <- read.csv("RL_010419CC.csv", header = T)
lifespan2 <- subset(lifespan2, select = c("Replicate", "Condition1", "Condition2", "Ageofdeath", "Censored", "Plate.Column", "Plate.Row", "Strain", "Dead"))
names(lifespan2) <- c("replicate", "condition.1", "condition.2", "death.age", "censored", "column", "row", "strain", "dead")
lifespan2$treatment <- with(lifespan2, interaction(condition.1, condition.2, strain))
lifespan2$plate <- with(lifespan2, interaction(replicate, column, row))
head(lifespan2)
JK574.equal <- subset(lifespan2, treatment == "mated.equal.JK574", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
JK574.skew <- subset(lifespan2, treatment == "mated.skew.JK574", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
JK574.virgin <- subset(lifespan2, treatment == "virgin.null.JK574", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
combined.JK574 <- rbind(JK574.skew, JK574.virgin, JK574.equal)
combined.JK574$SurvObj <- with(combined.JK574, Surv(death.age, censored == 0))
model.plot2 <- survfit(SurvObj ~ treatment, data = combined.JK574, conf.type = "log-log")
summary(model.plot2)
mycols2 <- c("blue", "red", "green")
plot(model.plot2, las = 1, col = mycols2, lty = c(1,1,1), lwd = 2, xlab = "Age (Days)", xlim = c(0, 40),
ylab = "Survival", bty = "l")
legend("bottomleft", c("equal", "virgin", "skew)"),
lty = c(1,1,1), lwd = 2, cex = 1, col = mycols2, bty = "n")
combreml <- lmer(death.age ~ treatment + (1|replicate / plate), data = combined.JK574)
head(combined.JK574)
combreml <- lmer(death.age ~ treatment + (1|plate), data = combined.JK574)
combprofile <- profile(combreml)
summary(combreml)
confint(combprofile)
head(combined.JK574)
summary(glht(combreml, linfct = mcp(treatment = c("mated.skew.JK574 - mated.equal.JK574 =0",
"mated.skew.JK574 - virgin.null.JK574 =0",
"virgin.null.JK574 - mated.equal.JK574=0"))))
library(gdata)
library(coxme)
library(multcomp)
library(lme4)
library(survival)
library(dplyr)
library(RColorBrewer)
setwd("~/Desktop/scripts_and_data/csv files")
original <- read.csv(file="RL_031719.csv", header=TRUE, sep=",")
lifespan1 <- subset(original, select = c("Replicate", "Condition.1", "Condition.2", "Age.at.Death", "Censored", "Plate.Column", "Plate.Row", "Strain"))
names(lifespan1) <- c("replicate", "condition.1", "condition.2", "death.age", "censored", "column", "row", "strain")
lifespan1$treatment <- with(lifespan1, interaction(condition.1, condition.2, strain))
lifespan1$plate <- with(lifespan1, interaction(column, row))
lifespan1$dead <- 1
lifespan2 <- read.csv("RL_010419CC.csv", header = T)
lifespan2 <- subset(lifespan2, select = c("Replicate", "Condition1", "Condition2", "Ageofdeath", "Censored", "Plate.Column", "Plate.Row", "Strain", "Dead"))
names(lifespan2) <- c("replicate", "condition.1", "condition.2", "death.age", "censored", "column", "row", "strain", "dead")
lifespan2$treatment <- with(lifespan2, interaction(condition.1, condition.2, strain))
lifespan2$plate <- with(lifespan2, interaction(replicate, column, row))
head(lifespan2)
JK574.equal <- subset(lifespan2, treatment == "mated.equal.JK574", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
JK574.skew <- subset(lifespan2, treatment == "mated.skew.JK574", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
JK574.virgin <- subset(lifespan2, treatment == "virgin.null.JK574", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
combined.JK574 <- rbind(JK574.skew, JK574.virgin, JK574.equal)
head(combined.JK574)
combreml <- lmer(death.age ~ treatment + (1|plate), data = combined.JK574)
combprofile <- profile(combreml)
summary(combreml)
confint(combprofile)
summary(glht(combreml, linfct = mcp(treatment = c("mated.skew.JK574 - mated.equal.JK574 =0",
"mated.skew.JK574 - virgin.null.JK574 =0",
"virgin.null.JK574 - mated.equal.JK574=0"))))
combined.JK574$SurvObj <- with(combined.JK574, Surv(death.age, censored == 0))
model.plot2 <- survfit(SurvObj ~ treatment, data = combined.JK574, conf.type = "log-log")
summary(model.plot2)
lifespan3 <- read.csv("RL_031719.csv", header = T)
lifespan3 <- subset(lifespan3, select = c("Replicate", "Condition.1", "Condition.2", "Age.at.Death", "Censored", "Plate.Column", "Plate.Row", "Strain"))
names(lifespan3) <- c("replicate", "condition.1", "condition.2", "death.age", "censored", "column", "row", "strain")
lifespan3$treatment <- with(lifespan3, interaction(condition.1, condition.2, strain, replicate))
lifespan3$plate <- with(lifespan3, interaction(replicate, column, row))
lifespan3$dead <- 1
head(lifespan3)
lifespan2 <- read.csv("RL_010419CC.csv", header = T)
lifespan2 <- subset(lifespan2, select = c("Replicate", "Condition1", "Condition2", "Ageofdeath", "Censored", "Plate.Column", "Plate.Row", "Strain", "Dead"))
names(lifespan2) <- c("replicate", "condition.1", "condition.2", "death.age", "censored", "column", "row", "strain", "dead")
lifespan2$treatment <- with(lifespan2, interaction(condition.1, condition.2, strain, replicate))
lifespan2$plate <- with(lifespan2, interaction(replicate, column, row))
head(lifespan2)
JK574.mated.individual <- subset(lifespan3, treatment == "mated.skew.JK574.3", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
JK574.virgin.individual <- subset(lifespan3, treatment == "virgin.null.JK574.3", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
JK574.mated.group <- subset(lifespan2, treatment == "mated.skew.JK574.2", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
JK574.virgin.group <- subset(lifespan2, treatment == "virgin.null.JK574.2", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
combined.JK574 <- rbind(JK574.mated.individual, JK574.virgin.individual, JK574.mated.group, JK574.virgin.group)
head(combined.JK574)
combined.JK574$SurvObj <- with(combined.JK574, Surv(death.age, censored == 0))
model.plot2 <- survfit(SurvObj ~ treatment, data = combined.JK574, conf.type = "log-log")
summary(model.plot2)
mycols2 <- c("#501800", "#501800", "#ff802b", "#ff802b")
plot(model.plot2, las = 1, col = mycols2, lty = c(1, 3, 1, 3), lwd = 2, xlab = "Age (Days)", xlim = c(0, 40),
ylab = "Survival", bty = "l")
legend("bottomleft", c("Individual virgins", "Individual mated 3:1", "Group virgins", "Group mated 3:1"),
lty = c(1, 3, 1, 3), lwd = 2, cex = 1, col = mycols2, bty = "n")
plot(model.plot2, las = 1, col = mycols2, lty = c(3, 1, 3, 1), lwd = 2, xlab = "Age (Days)", xlim = c(0, 40),
ylab = "Survival", bty = "l")
legend("bottomleft", c("Individual virgins", "Individual mated 3:1", "Group virgins", "Group mated 3:1"),
lty = c(3,1,3,1), lwd = 2, cex = 1, col = mycols2, bty = "n")
lifespan1 <- read.csv("RL_110918COMB.csv", header = T)
lifespan1 <- subset(lifespan1, select = c("Replicate", "Strain",
"Age.at.Death..d..Raw", "Censored", "Plate.Column", "Plate.Row", "Genotype"))
names(lifespan1) <- c("replicate", "strain", "death.age", "censored", "column", "row", "treatment")
lifespan1$plate <- with(lifespan1, interaction(replicate, column, row))
lifespan1$dead <- 1
head(lifespan1)
lifespan2 <- read.csv("RL_010419CC.csv", header = T)
lifespan2 <- subset(lifespan2, select = c("Replicate", "Condition1", "Condition2", "Ageofdeath", "Censored", "Plate.Column", "Plate.Row", "Strain", "Dead"))
names(lifespan2) <- c("replicate", "condition.1", "condition.2", "death.age", "censored", "column", "row", "strain", "dead")
lifespan2$treatment <- with(lifespan2, interaction(condition.1, condition.2, strain))
lifespan2$plate <- with(lifespan2, interaction(replicate, column, row))
head(lifespan2)
lifespan3 <- read.csv("RL_031719.csv", header = T)
lifespan3 <- subset(lifespan3, select = c("Replicate", "Condition.1", "Condition.2", "Age.at.Death", "Censored", "Plate.Column", "Plate.Row", "Strain"))
names(lifespan3) <- c("replicate", "condition.1", "condition.2", "death.age", "censored", "column", "row", "strain")
lifespan3$treatment <- with(lifespan3, interaction(condition.1, condition.2, strain))
lifespan3$plate <- with(lifespan3, interaction(replicate, column, row))
lifespan3$dead <- 1
head(lifespan3)
lifespan1.mated <- subset(lifespan1, treatment == "mated.equal.PX632", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
lifespan1.virgin <- subset(lifespan1, treatment == "virgin.null.PX632", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
lifespan2.mated <- subset(lifespan2, treatment == "mated.equal.PX632", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
lifespan2.virgin <- subset(lifespan2, treatment == "virgin.null.PX632", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
lifespan2.skew <- subset(lifespan2, treatment == "mated.skew.PX632", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
lifespan3.mated <- subset(lifespan3, treatment == "mated.equal.PX632", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
lifespan3.virgin <- subset(lifespan3, treatment == "virgin.null.PX632", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
lifespan3.skew <- subset(lifespan3, treatment == "mated.skew.PX632", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
head(lifespan1.mated)
head(lifespan2.virgin)
head(lifespan3.mated)
combined.PX632 <- rbind(lifespan1.mated, lifespan1.virgin, lifespan2.mated, lifespan2.virgin, lifespan2.skew, lifespan3.mated, lifespan3.virgin, lifespan3.skew)
head(combined.PX632)
tail(combined.PX632)
## Plot
combined.PX632$SurvObj <- with(combined.PX632, Surv(death.age, censored == 0))
model.plot2 <- survfit(SurvObj ~ treatment, data = combined.PX632, conf.type = "log-log")
summary(model.plot2)
# "NGM_mated", "NGM_virgin", "PX632.mated.equal", "PX632.virgin.null"
mycols2 <- c("#4286f4", "#6ba3ff","#01317f")
plot(model.plot2, las = 1, col = mycols2, lty = c(1,3,1), lwd = 2, xlab = "Age (Days)", xlim = c(0, 40),
ylab = "Survival", bty = "l")
legend("bottomleft", c("mated.equal.PX632","virgin.null.PX632 ","mated.skew.PX632"),
lty = c(1,3,1), lwd = 2, cex = 1, col = mycols2, bty = "n")
setwd("~/Desktop/scripts_and_data/csv files")
original <- read.csv(file="RL_031719.csv", header=TRUE, sep=",")
lifespan1 <- subset(original, select = c("Replicate", "Condition.1", "Condition.2", "Age.at.Death", "Censored", "Plate.Column", "Plate.Row", "Strain"))
names(lifespan1) <- c("replicate", "condition.1", "condition.2", "death.age", "censored", "column", "row", "strain")
lifespan1$treatment <- with(lifespan1, interaction(condition.1, condition.2, strain))
lifespan1$plate <- with(lifespan1, interaction(column, row))
lifespan1$dead <- 1
lifespan2 <- read.csv("RL_010419CC.csv", header = T)
lifespan2 <- subset(lifespan2, select = c("Replicate", "Condition1", "Condition2", "Ageofdeath", "Censored", "Plate.Column", "Plate.Row", "Strain", "Dead"))
names(lifespan2) <- c("replicate", "condition.1", "condition.2", "death.age", "censored", "column", "row", "strain", "dead")
lifespan2$treatment <- with(lifespan2, interaction(condition.1, condition.2, strain))
lifespan2$plate <- with(lifespan2, interaction(replicate, column, row))
head(lifespan2)
JK574.equal <- subset(lifespan2, treatment == "mated.equal.JK574", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
JK574.skew <- subset(lifespan2, treatment == "mated.skew.JK574", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
JK574.virgin <- subset(lifespan2, treatment == "virgin.null.JK574", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
combined.JK574 <- rbind(JK574.skew, JK574.virgin, JK574.equal)
head(combined.JK574)
combreml <- lmer(death.age ~ treatment + (1|plate), data = combined.JK574)
combprofile <- profile(combreml)
summary(combreml)
confint(combprofile)
summary(glht(combreml, linfct = mcp(treatment = c("mated.skew.JK574 - mated.equal.JK574 =0",
"mated.skew.JK574 - virgin.null.JK574 =0",
"virgin.null.JK574 - mated.equal.JK574=0"))))
combined.JK574$SurvObj <- with(combined.JK574, Surv(death.age, censored == 0))
model.plot2 <- survfit(SurvObj ~ treatment, data = combined.JK574, conf.type = "log-log")
summary(model.plot2)
mycols2 <- c("blue", "red", "green")
plot(model.plot2, las = 1, col = mycols2, lty = c(1,1,1), lwd = 2, xlab = "Age (Days)", xlim = c(0, 40),
ylab = "Survival", bty = "l")
legend("bottomleft", c("equal", "virgin", "skew)"),
lty = c(1,1,1), lwd = 2, cex = 1, col = mycols2, bty = "n")
mycols2 <- c("#501800", "#501800", "#ff802b")
plot(model.plot2, las = 1, col = mycols2, lty = c(1,1,1), lwd = 2, xlab = "Age (Days)", xlim = c(0, 40),
ylab = "Survival", bty = "l")
legend("bottomleft", c("equal", "virgin", "skew)"),
lty = c(1,1,1), lwd = 2, cex = 1, col = mycols2, bty = "n")
mycols2 <- c("#ff802b", "#501800", "#501800")
plot(model.plot2, las = 1, col = mycols2, lty = c(1,3,1), lwd = 2, xlab = "Age (Days)", xlim = c(0, 40),
ylab = "Survival", bty = "l")
legend("bottomleft", c("equal", "virgin", "skew)"),
lty = c(1,1,1), lwd = 2, cex = 1, col = mycols2, bty = "n")
mycols2 <- c("#ff802b", "#ff802b", "#501800")
plot(model.plot2, las = 1, col = mycols2, lty = c(1,3,1), lwd = 2, xlab = "Age (Days)", xlim = c(0, 40),
ylab = "Survival", bty = "l")
legend("bottomleft", c("equal", "virgin", "skew)"),
lty = c(1,1,1), lwd = 2, cex = 1, col = mycols2, bty = "n")
legend("bottomleft", c("equal", "virgin", "skew)"),
lty = c(1,3,1), lwd = 2, cex = 1, col = mycols2, bty = "n")
plot(model.plot2, las = 1, col = mycols2, lty = c(1,3,1), lwd = 2, xlab = "Age (Days)", xlim = c(0, 40),
ylab = "Survival", bty = "l")
legend("bottomleft", c("equal", "virgin", "skew)"),
lty = c(1,3,1), lwd = 2, cex = 1, col = mycols2, bty = "n")
setwd("~/Desktop/scripts_and_data/csv files")
lifespan1 <- read.csv("RL_110918COMB.csv", header = T)
lifespan1 <- subset(lifespan1, select = c("Replicate", "Strain",
"Age.at.Death..d..Raw", "Censored", "Plate.Column", "Plate.Row", "Genotype"))
names(lifespan1) <- c("replicate", "strain", "death.age", "censored", "column", "row", "treatment")
lifespan1$plate <- with(lifespan1, interaction(replicate, column, row))
lifespan1$dead <- 1
head(lifespan1)
lifespan2 <- read.csv("RL_010419CC.csv", header = T)
lifespan2 <- subset(lifespan2, select = c("Replicate", "Condition1", "Condition2", "Ageofdeath", "Censored", "Plate.Column", "Plate.Row", "Strain", "Dead"))
names(lifespan2) <- c("replicate", "condition.1", "condition.2", "death.age", "censored", "column", "row", "strain", "dead")
lifespan2$treatment <- with(lifespan2, interaction(condition.1, condition.2, strain))
lifespan2$plate <- with(lifespan2, interaction(replicate, column, row))
head(lifespan2)
lifespan3 <- read.csv("RL_031719.csv", header = T)
lifespan3 <- subset(lifespan3, select = c("Replicate", "Condition.1", "Condition.2", "Age.at.Death", "Censored", "Plate.Column", "Plate.Row", "Strain"))
names(lifespan3) <- c("replicate", "condition.1", "condition.2", "death.age", "censored", "column", "row", "strain")
lifespan3$treatment <- with(lifespan3, interaction(condition.1, condition.2, strain))
lifespan3$plate <- with(lifespan3, interaction(replicate, column, row))
lifespan3$dead <- 1
head(lifespan3)
lifespan1.mated <- subset(lifespan1, treatment == "mated.equal.PX632", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
lifespan1.virgin <- subset(lifespan1, treatment == "virgin.null.PX632", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
lifespan2.mated <- subset(lifespan2, treatment == "mated.equal.PX632", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
lifespan2.virgin <- subset(lifespan2, treatment == "virgin.null.PX632", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
lifespan3.mated <- subset(lifespan3, treatment == "mated.equal.PX632", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
lifespan3.virgin <- subset(lifespan3, treatment == "virgin.null.PX632", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
combined.PX632 <- rbind(lifespan1.mated, lifespan1.virgin,  lifespan2.mated, lifespan2.virgin, lifespan3.mated, lifespan3.virgin)
lifespan2.mated.J <- subset(lifespan2, treatment == "mated.equal.JK574", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
lifespan2.virgin.J <- subset(lifespan2, treatment == "virgin.null.JK574", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
combined.JK574 <- rbind(lifespan2.mated.J, lifespan2.virgin.J)
worm <-rbind(combined.JK574, combined.PX632)
worm$SurvObj <- with(combined.JK574, Surv(death.age, censored == 0))
model.plot2 <- survfit(SurvObj ~ treatment, data = worm, conf.type = "log-log")
summary(model.plot2)
mycols <- c("#ff9216","#ffb159","#5495ff","#8cb8ff","#003a99")
plot(model.plot2, las = 1, col = mycols, lwd = 2, lty = c(1,3,1,3,1), xlab = "Age (Days)",
ylab = "Survival", bty = "l")
legend("bottomleft", c("mated.equal.JK574", "virgin.null.JK574", "mated.equal.PX632", "virgin.null.PX632"), lty = c(1,3,1,3,1,3), lwd = 2, cex = 0.95,
col = mycols, bty = "n")
lifespan1 <- read.csv("RL_110918COMB.csv", header = T)
lifespan1 <- subset(lifespan1, select = c("Replicate", "Strain",
"Age.at.Death..d..Raw", "Censored", "Plate.Column", "Plate.Row", "Genotype"))
names(lifespan1) <- c("replicate", "strain", "death.age", "censored", "column", "row", "treatment")
lifespan1$plate <- with(lifespan1, interaction(replicate, column, row))
lifespan1$dead <- 1
head(lifespan1)
lifespan2 <- read.csv("RL_010419CC.csv", header = T)
lifespan2 <- subset(lifespan2, select = c("Replicate", "Condition1", "Condition2", "Ageofdeath", "Censored", "Plate.Column", "Plate.Row", "Strain", "Dead"))
names(lifespan2) <- c("replicate", "condition.1", "condition.2", "death.age", "censored", "column", "row", "strain", "dead")
lifespan2$treatment <- with(lifespan2, interaction(condition.1, condition.2, strain))
lifespan2$plate <- with(lifespan2, interaction(replicate, column, row))
head(lifespan2)
lifespan3 <- read.csv("RL_031719.csv", header = T)
lifespan3 <- subset(lifespan3, select = c("Replicate", "Condition.1", "Condition.2", "Age.at.Death", "Censored", "Plate.Column", "Plate.Row", "Strain"))
names(lifespan3) <- c("replicate", "condition.1", "condition.2", "death.age", "censored", "column", "row", "strain")
lifespan3$treatment <- with(lifespan3, interaction(condition.1, condition.2, strain))
lifespan3$plate <- with(lifespan3, interaction(replicate, column, row))
lifespan3$dead <- 1
head(lifespan3)
lifespan1.mated <- subset(lifespan1, treatment == "mated.equal.PX632", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
lifespan1.virgin <- subset(lifespan1, treatment == "virgin.null.PX632", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
lifespan2.mated <- subset(lifespan2, treatment == "mated.equal.PX632", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
lifespan2.virgin <- subset(lifespan2, treatment == "virgin.null.PX632", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
lifespan3.mated <- subset(lifespan3, treatment == "mated.equal.PX632", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
lifespan3.virgin <- subset(lifespan3, treatment == "virgin.null.PX632", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
combined.PX632 <- rbind(lifespan1.mated, lifespan1.virgin,  lifespan2.mated, lifespan2.virgin, lifespan3.mated, lifespan3.virgin)
lifespan2.mated.J <- subset(lifespan2, treatment == "mated.equal.JK574", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
lifespan2.virgin.J <- subset(lifespan2, treatment == "virgin.null.JK574", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
combined.JK574 <- rbind(lifespan2.mated.J, lifespan2.virgin.J)
worm <-rbind(combined.JK574, combined.PX632)
worm$SurvObj <- with(combined.JK574, Surv(death.age, censored == 0))
model.plot2 <- survfit(SurvObj ~ treatment, data = worm, conf.type = "log-log")
summary(model.plot2)
mycols <- c("#ff9216","#ffb159","#5495ff","#8cb8ff","#003a99")
plot(model.plot2, las = 1, col = mycols, lwd = 2, lty = c(1,3,1,3,1), xlab = "Age (Days)",
ylab = "Survival", bty = "l")
legend("bottomleft", c("mated.equal.JK574", "virgin.null.JK574", "mated.equal.PX632", "virgin.null.PX632"), lty = c(1,3,1,3,1,3), lwd = 2, cex = 0.95,
col = mycols, bty = "n")
setwd("~/Desktop/scripts_and_data/csv files")
original <- read.csv(file="RL_031719.csv", header=TRUE, sep=",")
lifespan1 <- subset(original, select = c("Replicate", "Condition.1", "Condition.2", "Age.at.Death", "Censored", "Plate.Column", "Plate.Row", "Strain"))
names(lifespan1) <- c("replicate", "condition.1", "condition.2", "death.age", "censored", "column", "row", "strain")
lifespan1$treatment <- with(lifespan1, interaction(condition.1, condition.2, strain))
lifespan1$plate <- with(lifespan1, interaction(column, row))
lifespan1$dead <- 1
lifespan2 <- read.csv("RL_010419CC.csv", header = T)
lifespan2 <- subset(lifespan2, select = c("Replicate", "Condition1", "Condition2", "Ageofdeath", "Censored", "Plate.Column", "Plate.Row", "Strain", "Dead"))
names(lifespan2) <- c("replicate", "condition.1", "condition.2", "death.age", "censored", "column", "row", "strain", "dead")
lifespan2$treatment <- with(lifespan2, interaction(condition.1, condition.2, strain))
lifespan2$plate <- with(lifespan2, interaction(replicate, column, row))
head(lifespan2)
JK574.equal <- subset(lifespan2, treatment == "mated.equal.JK574", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
JK574.skew <- subset(lifespan2, treatment == "mated.skew.JK574", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
JK574.virgin <- subset(lifespan2, treatment == "virgin.null.JK574", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
combined.JK574 <- rbind(JK574.skew, JK574.virgin, JK574.equal)
head(combined.JK574)
combined.JK574$SurvObj <- with(combined.JK574, Surv(death.age, censored == 0))
model.plot2 <- survfit(SurvObj ~ treatment, data = combined.JK574, conf.type = "log-log")
summary(model.plot2)
mycols2 <- c("blue", "red", "green")
plot(model.plot2, las = 1, col = mycols2, lty = c(1,1,1), lwd = 2, xlab = "Age (Days)", xlim = c(0, 40),
ylab = "Survival", bty = "l")
legend("bottomleft", c("equal", "virgin", "skew)"),
lty = c(1,1,1), lwd = 2, cex = 1, col = mycols2, bty = "n")
lifespan3 <- read.csv("RL_031719.csv", header = T)
lifespan3 <- subset(lifespan3, select = c("Replicate", "Condition.1", "Condition.2", "Age.at.Death", "Censored", "Plate.Column", "Plate.Row", "Strain"))
names(lifespan3) <- c("replicate", "condition.1", "condition.2", "death.age", "censored", "column", "row", "strain")
lifespan3$treatment <- with(lifespan3, interaction(condition.1, condition.2, strain, replicate))
lifespan3$plate <- with(lifespan3, interaction(replicate, column, row))
lifespan3$dead <- 1
head(lifespan3)
lifespan2 <- read.csv("RL_010419CC.csv", header = T)
lifespan2 <- subset(lifespan2, select = c("Replicate", "Condition1", "Condition2", "Ageofdeath", "Censored", "Plate.Column", "Plate.Row", "Strain", "Dead"))
names(lifespan2) <- c("replicate", "condition.1", "condition.2", "death.age", "censored", "column", "row", "strain", "dead")
lifespan2$treatment <- with(lifespan2, interaction(condition.1, condition.2, strain, replicate))
lifespan2$plate <- with(lifespan2, interaction(replicate, column, row))
head(lifespan2)
JK574.mated.individual <- subset(lifespan3, treatment == "mated.skew.JK574.3", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
JK574.virgin.individual <- subset(lifespan3, treatment == "virgin.null.JK574.3", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
JK574.mated.group <- subset(lifespan2, treatment == "mated.skew.JK574.2", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
JK574.virgin.group <- subset(lifespan2, treatment == "virgin.null.JK574.2", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
combined.JK574 <- rbind(JK574.mated.individual, JK574.virgin.individual, JK574.mated.group, JK574.virgin.group)
head(combined.JK574)
combined.JK574$SurvObj <- with(combined.JK574, Surv(death.age, censored == 0))
model.plot2 <- survfit(SurvObj ~ treatment, data = combined.JK574, conf.type = "log-log")
summary(model.plot2)
mycols2 <- c("#501800", "#501800", "#ff802b", "#ff802b")
plot(model.plot2, las = 1, col = mycols2, lty = c(1, 3, 1, 3), lwd = 2, xlab = "Age (Days)", xlim = c(0, 40),
ylab = "Survival", bty = "l")
legend("bottomleft", c("Individual virgins", "Individual mated 3:1", "Group virgins", "Group mated 3:1"),
lty = c(1, 3, 1, 3), lwd = 2, cex = 1, col = mycols2, bty = "n")
JK574.mated.individual <- subset(lifespan3, treatment == "mated.skew.JK574.3", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
JK574.virgin.individual <- subset(lifespan3, treatment == "virgin.null.JK574.3", select = c("replicate", "strain", "death.age", "censored", "plate", "treatment"))
combined.JK574 <- rbind(JK574.mated.individual, JK574.virgin.individual)
combined.JK574$SurvObj <- with(combined.JK574, Surv(death.age, censored == 0))
model.plot2 <- survfit(SurvObj ~ treatment, data = combined.JK574, conf.type = "log-log")
summary(model.plot2)
mycols2 <- c("#501800", "#501800", "#ff802b", "#ff802b")
plot(model.plot2, las = 1, col = mycols2, lty = c(1, 3, 1, 3), lwd = 2, xlab = "Age (Days)", xlim = c(0, 40),
ylab = "Survival", bty = "l")
legend("bottomleft", c("Individual virgins", "Individual mated 3:1", "Group virgins", "Group mated 3:1"),
lty = c(1, 3, 1, 3), lwd = 2, cex = 1, col = mycols2, bty = "n")
mycols2 <- c("#ff802b", "#ff802b")
plot(model.plot2, las = 1, col = mycols2, lty = c(1, 3, 1, 3), lwd = 2, xlab = "Age (Days)", xlim = c(0, 40),
ylab = "Survival", bty = "l")
legend("bottomleft", c("Individual virgins", "Individual mated 3:1"),
lty = c(1, 3, 1, 3), lwd = 2, cex = 1, col = mycols2, bty = "n")
plot(model.plot2, las = 1, col = mycols2, lty = c(3,1, 1, 3), lwd = 2, xlab = "Age (Days)", xlim = c(0, 40),
ylab = "Survival", bty = "l")
legend("bottomleft", c("Individual virgins", "Individual mated 3:1"),
lty = c(3,1, 1, 3), lwd = 2, cex = 1, col = mycols2, bty = "n")
mycols2 <- c("#501800", "#501800")
plot(model.plot2, las = 1, col = mycols2, lty = c(1, 3, 1, 3), lwd = 2, xlab = "Age (Days)", xlim = c(0, 40),
ylab = "Survival", bty = "l")
legend("bottomleft", c("Individual virgins", "Individual mated 3:1", "Group virgins", "Group mated 3:1"),
lty = c(1, 3, 1, 3), lwd = 2, cex = 1, col = mycols2, bty = "n")
plot(model.plot2, las = 1, col = mycols2, lty = c(3, 1, 3), lwd = 2, xlab = "Age (Days)", xlim = c(0, 40),
ylab = "Survival", bty = "l")
legend("bottomleft", c("Individual virgins", "Individual mated 3:1", "Group virgins", "Group mated 3:1"),
lty = c( 3, 1, 3), lwd = 2, cex = 1, col = mycols2, bty = "n")
